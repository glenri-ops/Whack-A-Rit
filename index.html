<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Whack-A-Rit</title>

<style>
html,body{
  margin:0;height:100%;background:#000;
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  -webkit-tap-highlight-color:transparent;
  overscroll-behavior:none
}
body{touch-action:manipulation}
#app{position:relative;width:100%;height:100%;overflow:hidden}

#bg{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}
#table{
  position:absolute;left:50%;top:56%;
  transform:translate(-50%,-50%);
  width:min(94vw,900px);
  opacity:0;transition:.25s
}

/* HUD */
#hud{
  position:absolute;left:50%;top:8%;
  transform:translateX(-50%);
  background:#00c853;color:#fff;
  padding:14px 22px;border-radius:18px;
  font-size:26px;font-weight:900;
  display:none;z-index:10
}

/* Overlay */
#overlay{
  position:absolute;inset:0;
  display:flex;flex-direction:column;
  justify-content:center;align-items:center;
  gap:12px;background:rgba(0,0,0,.5);z-index:20
}
#play{
  background:#00c853;color:#fff;
  border:none;border-radius:18px;
  padding:18px 40px;font-size:22px;font-weight:900
}
#msg{color:#fff;font-weight:800}

/* holes */
.hole{position:absolute;width:96px;height:96px}
.target{
  position:absolute;left:0;right:0;margin:auto;bottom:-40px;
  width:96px;height:96px;border-radius:50%;
  background:#111;display:flex;align-items:center;justify-content:center;
  opacity:0;transform:scale(.9);transition:.15s
}
.target.show{opacity:1;transform:scale(1);bottom:0}
.target img{width:92px;height:92px;border-radius:50%}

/* hammer */
#hammer{
  position:absolute;font-size:54px;
  pointer-events:none;display:none;z-index:999;
  transform:translate(-50%,-50%) rotate(-35deg)
}

/* Level 5 boss */
#boss5{
  position:absolute;inset:0;
  display:none;z-index:40;
  background:rgba(0,0,0,.7);
  align-items:center;justify-content:center
}
#boss5 img{width:min(80vw,520px)}

/* Level 30 mercy */
#mercy{
  position:absolute;inset:0;
  display:none;z-index:50;
  background:rgba(0,0,0,.78)
}
#mercyCenter{
  position:absolute;left:50%;top:50%;
  transform:translate(-50%,-50%);
  text-align:center;color:#fff
}
#mercyCenter img{width:min(70vw,420px)}
#mercyText{margin-top:12px;font-size:22px;font-weight:900}

#smallRitos{
  position:absolute;width:70px;height:70px;
  display:none;cursor:pointer;
  border-radius:50%;
}
#smallRitos img{width:100%;height:100%;border-radius:50%}
</style>
</head>

<body>
<div id="app">

<img id="bg" src="./bg.png">
<img id="table" src="./table.png">

<div id="hud">Score: <span id="score">0</span></div>

<div id="overlay">
  <button id="play">Play</button>
  <div id="msg">Hit Ritos for points. Avoid Tiga ðŸ˜ˆ</div>
</div>

<!-- Level 5 boss -->
<div id="boss5">
  <img src="./boss.png">
</div>

<!-- Level 30 mercy -->
<div id="mercy">
  <div id="mercyCenter">
    <img src="./mercy.png">
    <div id="mercyText">Donâ€™t hit meâ€¦ ðŸ¥º</div>
  </div>
  <div id="smallRitos">
    <img src="./bad.png">
  </div>
</div>

<div id="hammer">ðŸ”¨</div>

<script>
(() => {

const GOOD="./good.png";
const BAD ="./bad.png";

const holes=[
  {x:.2,y:.62},{x:.5,y:.63},{x:.8,y:.62},
  {x:.2,y:.4},{x:.5,y:.4},{x:.8,y:.4}
];

let score=0,running=false,active=null,timer=null;
let inBoss=false;

/* DOM */
const table=document.getElementById("table");
const hud=document.getElementById("hud");
const scoreEl=document.getElementById("score");
const overlay=document.getElementById("overlay");
const mercy=document.getElementById("mercy");
const smallRitos=document.getElementById("smallRitos");
const boss5=document.getElementById("boss5");
const hammer=document.getElementById("hammer");

/* hammer */
document.addEventListener("pointerdown",e=>{
  hammer.style.left=e.clientX+"px";
  hammer.style.top=e.clientY+"px";
  hammer.style.display="block";
});
document.addEventListener("pointerup",()=>hammer.style.display="none");

function gameOver(){
  running=false;inBoss=false;
  overlay.style.display="flex";
  table.style.opacity=0;
  hud.style.display="none";
  mercy.style.display="none";
  boss5.style.display="none";
}

/* Level 5 bonus */
function level5(){
  inBoss=true;running=false;
  boss5.style.display="flex";
  let end=Date.now()+3000;
  boss5.onclick=()=>{
    score++;scoreEl.textContent=score;
  };
  const move=setInterval(()=>{
    boss5.firstElementChild.style.transform=
      `translateX(${Math.sin(Date.now()/200)*120}px)`;
    if(Date.now()>end){
      clearInterval(move);
      boss5.style.display="none";
      inBoss=false;running=true;
      loop();
    }
  },16);
}

/* Level 30 Mercy â€“ FIXED MOVEMENT */
function level30(){
  inBoss=true;running=false;
  mercy.style.display="block";
  smallRitos.style.display="block";

  let x=Math.random()*innerWidth;
  let y=Math.random()*innerHeight;
  let vx=(Math.random()-.5)*6;
  let vy=(Math.random()-.5)*6;

  function move(){
    if(!inBoss) return;

    x+=vx; y+=vy;

    if(x<20||x>innerWidth-90) vx*=-1;
    if(y<20||y>innerHeight-90) vy*=-1;

    // occasionally pass near Tiga
    if(Math.random()<0.01){
      const cx=innerWidth/2;
      const cy=innerHeight/2;
      vx+=(cx-x)*0.0008;
      vy+=(cy-y)*0.0008;
    }

    smallRitos.style.left=x+"px";
    smallRitos.style.top=y+"px";

    requestAnimationFrame(move);
  }
  move();

  smallRitos.onclick=e=>{
    e.stopPropagation();
    score+=5;scoreEl.textContent=score;
    endLevel30();
  };

  mercy.onclick=()=>{
    alert("You hit Tiga... ðŸ¥º\nTiga is very sad now....ðŸ˜­");
    gameOver();
  };

  setTimeout(endLevel30,8000);
}

function endLevel30(){
  inBoss=false;
  mercy.style.display="none";
  running=true;
  loop();
}

/* spawn */
function spawn(){
  if(!running||inBoss) return;
  if(active) active.remove();

  const r=table.getBoundingClientRect();
  const h=holes[Math.floor(Math.random()*holes.length)];

  const hole=document.createElement("div");
  hole.className="hole";
  hole.style.left=(r.left+h.x*r.width-48)+"px";
  hole.style.top=(r.top+(1-h.y)*r.height-48)+"px";

  const isGood=Math.random()<.25;
  const t=document.createElement("div");
  t.className="target";
  t.innerHTML=`<img src="${isGood?GOOD:BAD}">`;

  t.onclick=()=>{
    if(isGood){gameOver();}
    else{
      score++;scoreEl.textContent=score;
      if(score===5){level5();return;}
      if(score===30){level30();return;}
      t.remove();
    }
  };

  hole.appendChild(t);
  document.body.appendChild(hole);
  active=hole;

  requestAnimationFrame(()=>t.classList.add("show"));
  setTimeout(()=>{if(active===hole) hole.remove();},1200);
}

function loop(){
  spawn();
  timer=setTimeout(loop,1300);
}

document.getElementById("play").onclick=()=>{
  score=0;scoreEl.textContent=0;
  running=true;inBoss=false;
  overlay.style.display="none";
  table.style.opacity=1;
  hud.style.display="block";
  loop();
};

})();
</script>
</body>
</html>
